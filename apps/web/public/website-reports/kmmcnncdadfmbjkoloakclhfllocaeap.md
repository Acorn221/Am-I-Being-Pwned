# Saladict Extension Security Analysis (VULN_REPORT)

**Extension:** Saladict: Online Dictionary & Text Selection & Immersive Translation
**ID:** kmmcnncdadfmbjkoloakclhfllocaeap
**Version:** 10.0.1
**Manifest Version:** 3
**Homepage:** https://saladict.net/
**Analysis Date:** 2026-02-06

---

## Executive Summary

Saladict is a legitimate, well-known open-source pop-up dictionary and page translation extension primarily targeting Chinese-speaking users who need multi-dictionary lookup and translation services. It is **not malware**. The 131 T1 flags and 9 T2 flags generated by automated triage are overwhelmingly false positives arising from:

1. Bundled third-party libraries (Raven.js/Sentry, Tesseract.js OCR, Axios, Regenerator Runtime, Google Translate element scripts, Youdao dictionary SDK)
2. Legitimate translation service integrations requiring CORS bypass (30+ dictionary/translation APIs)
3. Page translation functionality that necessarily reads page content and injects translations
4. An embedded PDF viewer (PDF.js)

However, there are **two genuine security concerns** of moderate severity:

- **Remote Kill Switch:** The server at `saladict.net/api` can remotely disable the extension for all users via the `/extension-check-notify` endpoint, and push arbitrary notification messages with clickable URLs.
- **Open Fetch Proxy:** The `fetchUrl` message handler in the background script acts as an unauthenticated fetch proxy, allowing any content script (or any page with access to the extension's messaging) to make arbitrary HTTP requests with cookies attached (`credentials: "include"`).

Overall risk assessment: **LOW** -- This is a legitimate tool with standard translation-extension behaviors. The concerns identified are common patterns in translation extensions and do not indicate malicious intent.

---

## True Positive Findings

### VULN-01: Remote Extension Kill Switch via Server-Controlled Configuration

**Severity:** MEDIUM (CVSS 5.3 -- AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L)
**File:** `assets/background.634d1aeb.js` lines 6657-6716
**Category:** remote_config, C2-like behavior

**Description:**
On startup, the extension fetches `https://saladict.net/api/extension-check-notify?language={lang}` and parses the server response. If the response contains a `minSupportVersion` field greater than the installed extension version, the extension sets `extensionDisabled: true` in its configuration, which causes ALL translation requests to be rejected across all content scripts (verified at lines 2869, 3175, 3840, 4146, etc.).

Additionally, the server can push arbitrary notification messages with a URL button that opens any URL when clicked.

```javascript
// background.634d1aeb.js:6667
t = await fetch(`${r.a.translateBaseUrl}/extension-check-notify?language=${e}`, {
    method: "GET",
    headers: { "Content-Type": "application/json" }
}),

// Line 6688-6693: Remote disable
message: `Thank you for using Saladict. To ensure functionality integrity and security,
we have discontinued support for the current version. Please upgrade to
${n.minSupportVersion} or higher to continue using the full functionality.`
// ...
extensionDisabled: !0

// Line 6708-6714: Remote URL push via notification
buttons: n.url ? [{ title: e ? "Click to Go" : "Click to Go" }] : []
// ...
browser.notifications.onButtonClicked.addListener((e, t) => {
    0 === t && n.url && Object(i.b)(n.url)
})
```

**PoC Scenario:**
If saladict.net is compromised or the domain expires, an attacker could:
1. Serve a response with `minSupportVersion: "999.0.0"` to disable the extension for all users
2. Serve a notification with a phishing URL to redirect users to a malicious page

**Mitigating Factors:**
- This is a standard forced-update mechanism used by many extensions
- The domain is actively maintained
- The disable only affects translation features, not browser security
- Users must click the notification button to visit the URL

---

### VULN-02: Background Script Open Fetch Proxy with Credential Inclusion

**Severity:** LOW-MEDIUM (CVSS 4.3 -- AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:N/A:N)
**File:** `assets/background.634d1aeb.js` lines 6793-6813
**Category:** fetch_hook, http_endpoint

**Description:**
The background script listens for `fetchUrl` messages and makes fetch requests to arbitrary URLs with `credentials: "include"`, forwarding user cookies. Any content script in the extension can trigger this.

```javascript
// background.634d1aeb.js:6793-6812
browser.runtime.onMessage.addListener(e => {
    if ("fetchUrl" === e.contentScriptQuery) {
        const t = {
            method: e.method || "GET",
            credentials: "include",
            headers: {
                ...e.headers || {},
                "content-type": "application/json"
            }
        };
        if (e.data) try {
            t.body = JSON.stringify(e.data)
        } catch (e) {}
        return fetch(e.url, t).then(e => e.text()).then(e => ({
            status: "ok", data: e
        })).catch(e => ({
            status: "error", error: e
        }))
    }
});
```

**PoC Scenario:**
Since the extension injects content scripts on `<all_urls>`, if any content script is compromised or if a web page can inject messages into the extension context, it could use this proxy to:
1. Make authenticated requests to any site the user is logged into
2. Read response bodies from cross-origin requests

**Mitigating Factors:**
- In MV3, `runtime.onMessage` is only accessible from extension contexts (content scripts, popup, etc.), not from web pages
- This pattern is common in translation extensions that need to fetch dictionary pages from many origins
- The net_request_rules already handle CORS for most dictionary sites
- The fetch proxy is specifically designed for the Caiyun translation integration (trs.js)

---

### VULN-03: WTW_INJECT Arbitrary Script File Execution

**Severity:** LOW (CVSS 3.1 -- AV:L/AC:H/PR:N/UI:R/S:U/C:N/I:L/A:N)
**File:** `assets/background.634d1aeb.js` lines 3517-3531
**Category:** script_injection, dynamic_import

**Description:**
The background script listens for `WTW_INJECT` messages and executes arbitrary JavaScript files in the sender's tab using `scripting.executeScript`.

```javascript
// background.634d1aeb.js:3517-3529
(n ? chrome : browser).runtime.onMessage.addListener((e, t, a) => {
    if (e && "WTW_INJECT" === e.type && t && t.tab && null != t.tab.id) {
        let i = e.file;
        try { i = new URL(i).pathname } catch {}
        return n ? chrome.scripting.executeScript({
            target: { tabId: t.tab.id, frameIds: [t.frameId] },
            files: [i]
        }).then(a) : browser.executeScript(t.tab.id, details).then(a), !0
    }
})
```

**Mitigating Factors:**
- `scripting.executeScript` with `files:` can only load files bundled within the extension package
- The `new URL(i).pathname` extraction prevents full URL injection
- This is part of the web-translate-widget (WTW) integration for page translation
- Only reachable from within the extension's own content scripts

---

### VULN-04: Aggressive CSP and CORS Header Stripping

**Severity:** LOW (CVSS 2.4 -- AV:N/AC:L/PR:H/UI:R/S:U/C:N/I:L/A:N)
**File:** `assets/net_request_rules.json` (38 rules, 945 lines)
**File:** `assets/background.634d1aeb.js` lines 6620-6640
**Category:** csp_unsafe_eval, http_endpoint

**Description:**
The extension ships with 38 declarative net request rules that strip `content-security-policy`, `cross-origin-opener-policy`, `Cross-Origin-Resource-Policy`, and `Access-Control-Allow-Origin` headers from responses of 30+ dictionary and translation domains (DeepL, Google Translate, Youdao, Cambridge, Oxford, Wikipedia, Merriam-Webster, etc.). Additionally, it dynamically creates rules to strip CSP from user-configured domains for PDF viewing.

The rules also spoof `Origin` and `Referer` headers for several services (DeepL, Caiyun, zdic, mojidict, Naver, Tencent).

**Mitigating Factors:**
- This is a necessary evil for translation extensions that need to scrape dictionary pages cross-origin
- Rules are scoped to specific dictionary/translation domains, not blanket wildcards
- This is a well-established pattern used by virtually all multi-dictionary extensions
- In MV3, these rules are declaratively defined and auditable

---

## False Positive Analysis

| # | Flag Category | Count | Example File:Line | Verdict | Explanation |
|---|--------------|-------|--------------------|---------|-------------|
| 1 | **cookie_access** | 1 | `background.634d1aeb.js:16674` | **FALSE POSITIVE** | Single call to `browser.cookies.get()` to check Shanbay (word-learning app) login status via `auth_token` cookie. Not harvesting cookies. |
| 2 | **dynamic_eval** | ~50 | `fanyi.youdao.2.0/conn.js:132`, `fanyi.youdao.2.0/main.js:152` | **FALSE POSITIVE** | Youdao dictionary SDK using `eval('(' + text + ')')` as a JSON.parse fallback. This is a legacy pattern from pre-JSON.parse era. Not executing arbitrary code. |
| 3 | **dynamic_eval** | ~30 | `google/elms/elm_*.js:4134` | **FALSE POSITIVE** | Google Translate element scripts using `c.eval(f)` for dynamic module loading. This is Google's own code from the Translate widget. |
| 4 | **dynamic_function** | ~10 | `trs.js:4717`, `tesseract/worker.min.js:4132`, `25.3e0d5976.js:12526` | **FALSE POSITIVE** | `new Function("return this")()` -- standard globalThis polyfill pattern used in webpack bundles and library code (Regenerator Runtime, Tesseract.js, Raven/Sentry). |
| 5 | **dynamic_function** | 2 | `25.3e0d5976.js:23380`, `25.3e0d5976.js:23679-23680` | **FALSE POSITIVE** | Function.bind polyfill (`Function("binder", "return function...")`) and `eval("require('crypto')")` -- es5-ext library doing Node.js environment detection in Axios. |
| 6 | **script_injection** | 1 | `background.634d1aeb.js:3613-3614` | **FALSE POSITIVE** | `document.createElement("script")` with `textContent = e` labeled `saladict-Calendar injectInlineJs`. This is for injecting inline translation/page-translation scripts into the MAIN world. The content is controlled by the extension, not external sources. |
| 7 | **social_scraping** | ~20 | `content.5400cae4.js:22573-22684`, `popup.ebb629a1.js:23812-23922`, `options.1aa47b1f.js:30461-30571` | **FALSE POSITIVE** | CSS selector configurations for page translation on Facebook, Twitter, YouTube, Instagram, Reddit, Discord, Telegram, WhatsApp, Slack, etc. These are **DOM selectors for text extraction for translation**, not data scraping. They target visible text elements (headlines, messages, comments) to overlay translated text. This is core functionality for an immersive translation extension. |
| 8 | **fetch_hook / xhr_hook** | ~20 | `trs.js:3746-3809` | **FALSE POSITIVE** | Raven.js (Sentry error-tracking library) instrumenting `XMLHttpRequest.prototype.open/send` and `window.fetch` to create breadcrumb logs for error reporting. This only logs HTTP method, URL, and status code to Sentry, not request/response bodies. The Sentry DSN points to `sentry.in.caiyunapp.com/22` (CaiyunApp's Sentry instance) and is only used in trs.js (the Caiyun Translate content script). |
| 9 | **wasm_binary** | 4 | `assets/tesseract/tesseract.js-core/tesseract-core-*.wasm` | **FALSE POSITIVE** | Tesseract.js OCR engine WASM binaries. Used for screenshot-to-text translation (OCR). This is a well-known open-source library. The CSP `wasm-unsafe-eval` permission in the manifest is specifically for this. |
| 10 | **csp_unsafe_eval** | 1 | `manifest.json:236` | **FALSE POSITIVE** | `"script-src 'self' 'wasm-unsafe-eval'"` -- Required for Tesseract.js WASM execution. This is the minimum CSP relaxation needed for WASM, not `unsafe-eval`. |
| 11 | **beacon_exfil** | 2 | `google/element_main.js:4091,4254` | **FALSE POSITIVE** | Google Translate element library referencing `navigator.sendBeacon` -- but the actual call is commented out (`// d = _.rd().navigator.sendBeacon(...)`). This is dead code from Google's analytics in their Translate widget. |
| 12 | **http_endpoint** | 3 | `background.634d1aeb.js:2214,4910,7982` | **FALSE POSITIVE** | Plain HTTP URLs for `dict-mobile.iciba.com` (ICIBA dictionary suggest API), `www.etymonline.com` (etymology dictionary), and `www.youdao.com` (Youdao dictionary). These are legacy dictionary API endpoints. Minor privacy concern but not malicious. |
| 13 | **dynamic_import** | 0 (in bg) | N/A | **FALSE POSITIVE** | No dynamic `import()` calls found in the background script. The `importScripts()` calls in `background.js` are standard MV3 service worker module loading of bundled files. |
| 14 | **data_compression** | ~18 | `content.5400cae4.js:883,899`, `tesseract/worker.min.js:436+` | **FALSE POSITIVE** | Zlib/deflate compression references in Tesseract.js (for image processing) and in pako.js (for PDF.js). No LZString or custom compression for data exfiltration. |
| 15 | **innerHTML** | ~8 | `background.634d1aeb.js:3709,3735,5228,8029,20252` | **FALSE POSITIVE** | innerHTML usage for rendering dictionary results (SVG star ratings, translation results, page translation paragraph splitting). The content comes from parsed dictionary HTML, not user input. |

---

## Network Communication Summary

### Legitimate Translation/Dictionary Endpoints (30+)
All requests are for dictionary lookups and translation:

| Domain | Purpose |
|--------|---------|
| `saladict.net/api` | Extension's own backend: update check, notification check, translation proxy (Azure, Caiyun, DeepL, Tencent) |
| `dict.youdao.com` | Youdao Dictionary |
| `cn.bing.com` | Bing Dictionary |
| `dictionary.cambridge.org` | Cambridge Dictionary |
| `www.collinsdictionary.com` | Collins COBUILD |
| `www.ldoceonline.com` | Longman Dictionary |
| `www.merriam-webster.com` | Merriam-Webster |
| `www.etymonline.com` | Etymology Online |
| `www2.deepl.com` | DeepL Translation |
| `translate.google.com` | Google Translate |
| `fanyi.baidu.com` | Baidu Translate |
| `api.mojidict.com` | MOJi Dictionary (Japanese) |
| `dict.eudic.net` | Eudic Dictionary |
| `www.zdic.net` | Zdic (Chinese character dictionary) |
| `dict.cnki.net` | CNKI Dictionary |
| `www.moedict.tw` | MOE Dictionary (Taiwan) |
| `zh.dict.naver.com` | Naver Dictionary |
| `www.shanbay.com` | Shanbay (word notebook sync) |
| `api.mojidict.com` | MOJi Dict API |
| `transmart.qq.com` | Tencent Transmart |
| `sentry.in.caiyunapp.com` | Sentry error reporting (Caiyun module only) |
| `dict-mobile.iciba.com` | ICIBA suggest API |

### User-Configured Endpoints
| Service | Purpose |
|---------|---------|
| `http://{host}:{port}` (user-configured) | Anki Connect API for flashcard sync |
| User-configured WebDAV URL | Word notebook sync via WebDAV |

---

## Extension Enumeration / Other Extension Interference

**NOT FOUND.** There is no `chrome.management` API usage. The `getAll()` calls are for `browser.windows.getAll()` (window management for quick-search panel positioning) and `browser.commands.getAll()` (listing keyboard shortcuts in the options page). The `uninstallSelf` and `setEnabled` references are in the browser-polyfill type definitions, not in actual code.

---

## Overall Risk Assessment: **LOW**

### Rationale

Saladict is a **well-known, actively maintained, open-source** dictionary and translation extension (GitHub: crimx/ext-saladict) with a large user base primarily in China. The extension's behaviors are entirely consistent with its stated purpose:

1. **It needs `<all_urls>` and content scripts on all pages** because it is a text-selection dictionary and page translator -- it must read selected text and page content to translate them.

2. **It needs to strip CORS/CSP headers** because it scrapes dictionary pages (Cambridge, Oxford, Merriam-Webster, etc.) directly to display definitions inline.

3. **It needs Tesseract.js WASM** for screenshot-to-text OCR translation.

4. **It needs cookies permission** for checking Shanbay login status (word notebook sync).

5. **The social media selectors** are for page translation overlay, not data harvesting.

6. **The XHR/fetch hooks** are from Raven.js (Sentry) in the Caiyun translation module only, for error reporting.

The two genuine concerns (remote kill switch and fetch proxy) are common patterns in commercial translation extensions and do not indicate malicious intent. The kill switch is a forced-update mechanism, and the fetch proxy is for cross-origin dictionary fetching.

**Confidence:** HIGH that this is a clean, legitimate extension.

---

## Appendix: File Inventory

| File | Size (lines) | Role |
|------|-------------|------|
| `background.js` | 7 | Service worker entry (imports bundles) |
| `assets/background.634d1aeb.js` | 24,373 | Main background bundle |
| `assets/content.5400cae4.js` | ~23,000 | Main content script |
| `assets/selection.80d80052.js` | ~22,000 | Text selection handler |
| `assets/page-translate.6bc56aef.js` | N/A | Page translation content script |
| `assets/screenshot-translate.fd8d58e8.js` | N/A | Screenshot translation |
| `assets/image-translate.167f79b8.js` | N/A | Image translation |
| `assets/popup.ebb629a1.js` | ~24,000 | Popup UI |
| `assets/options.1aa47b1f.js` | ~33,000 | Options page |
| `assets/trs.js` | ~5,000 | Caiyun Translate SDK (with Raven.js/Sentry) |
| `assets/view-vendor.9c79816b.js` | ~7,000 | React/Preact runtime |
| `assets/dexie.8d365c59.js` | ~2,300 | Dexie.js (IndexedDB wrapper) |
| `assets/franc.d7a1c1f2.js` | N/A | Language detection library |
| `assets/browser-polyfill.min.js` | N/A | WebExtension browser polyfill |
| `assets/fanyi.youdao.2.0/` | N/A | Youdao dictionary SDK (legacy) |
| `assets/google/` | N/A | Google Translate element scripts |
| `assets/tesseract/` | N/A | Tesseract.js OCR engine |
| `assets/net_request_rules.json` | 945 | 38 declarative net request rules |
| `assets/pdf/` | N/A | Embedded PDF.js viewer |
