# Vulnerability Report: ySense Addon

## Metadata
- **Extension ID**: hjnhcgkngeeahimbfhejeaiijecekhba
- **Extension Name**: ySense Addon
- **Version**: 4.0.1
- **Users**: ~60,000
- **Manifest Version**: 3
- **Analysis Date**: 2026-02-15

## Executive Summary

The ySense Addon is a legitimate browser extension for ySense.com (formerly ClixSense), a GPT (Get-Paid-To) platform owned by Prodege, LLC. The extension provides account status tracking, survey notifications, and quick access to the ySense platform. The extension is properly scoped to ySense domains and implements expected functionality for a companion extension.

The static analyzer flagged one exfiltration flow (chrome.storage.local.get → fetch), which upon manual inspection is legitimate: the extension fetches user account data from the official ySense API endpoint (addon.ysense.com) to display earnings, available surveys, and notifications. There is one minor security issue: a postMessage listener without origin validation, though its exposure is limited.

## Vulnerability Details

### 1. LOW: postMessage Handler Without Origin Validation

**Severity**: LOW
**Files**: listen.js
**CWE**: CWE-346 (Origin Validation Error)

**Description**: The content script in listen.js registers a window message listener that accepts messages from any origin without validation:

**Evidence**:
```javascript
// listen.js
window.addEventListener('message', (event) => {
  if (event.source == window && event.data.action == 'refresh') {
      chrome.runtime.sendMessage({action: 'refresh'})
  }
});
```

The listener only checks that `event.source == window` (ensuring the message came from the same window, not a cross-origin iframe), and only acts on messages with `action == 'refresh'`. This triggers a refresh of the extension data from the backend.

**Verdict**: While technically a security weakness, the impact is minimal. The content script only runs on `*.ysense.com` and `*.clixsense.com` domains (per manifest.json), and the only exposed action is triggering a data refresh. A malicious script on the ySense website could force the extension to refresh data more frequently than intended, but cannot inject arbitrary data or access sensitive information. This appears to be intentional functionality to allow the website to notify the extension when the user completes an action that should update the badge count.

## False Positives Analysis

**Exfiltration Flow (EXFILTRATION: chrome.storage.local.get → fetch)**

The static analyzer correctly identified that the extension retrieves data from chrome.storage and sends it to external servers. However, this is expected and legitimate behavior:

1. **Configuration retrieval**: The extension fetches a user-specific configuration from `addon.ysense.com/?c{userId}v{version}-{flags}` (line 170-174 in background.js)
2. **User identification**: The URL includes a user ID generated by `gerU()` function (random hex string) to retrieve personalized data
3. **Legitimate API**: The endpoint returns account statistics (earnings, survey count, notifications) which are displayed in the popup
4. **Proper domain**: All API calls are to official ySense domains (addon.ysense.com, www.ysense.com, go.ysense.com)
5. **Disclosed purpose**: The extension's stated purpose is "Keep track of your account status and receive alerts of new earning opportunities" which requires fetching this data

The extension does not exfiltrate browsing history, cookies from other sites, or any data beyond what's needed for its stated functionality.

## API Endpoints Analysis

| Endpoint | Purpose | Data Sent | Risk |
|----------|---------|-----------|------|
| addon.ysense.com | Fetch account data (earnings, surveys, notifications) | User ID (random hex), version, browser type, notification preferences | LOW - legitimate API for disclosed functionality |
| www.ysense.com | Homepage/navigation links | None (navigation only) | NONE |
| go.ysense.com/g/l/* | Dynamic redirect links for surveys/offers | None (navigation only) | NONE |

## Permissions Analysis

- **storage**: Used to persist user preferences (notification settings, sound alerts) and cache account data
- **tabs**: Used to open ySense pages when user clicks notification or popup links
- **notifications**: Used to show browser notifications for new surveys/tasks

All permissions are appropriate for the extension's stated functionality.

## Code Quality Observations

- Code is copyright Prodege, LLC (2020) - matches legitimate company behind ySense
- Uses MV3 (service worker background script)
- Content script scope is properly restricted to ySense domains only
- No obfuscation or suspicious patterns
- Includes developer comments and README
- Uses standard Chrome APIs without dynamic eval or code execution

## Overall Risk Assessment

**RISK LEVEL: LOW**

**Justification**: This is a legitimate extension from a known GPT company. The single identified vulnerability (postMessage without strict origin validation) has minimal impact due to the restricted content script scope and limited exposed functionality. The "exfiltration" flagged by static analysis is expected behavior for a companion extension that displays account data. The extension operates transparently within its disclosed purpose and does not access sensitive data beyond the ySense platform.

**Recommendation**: The postMessage handler could be improved by adding explicit origin validation, though the current risk is minimal. No action required from a security standpoint, but best practices suggest checking `event.origin` explicitly.
