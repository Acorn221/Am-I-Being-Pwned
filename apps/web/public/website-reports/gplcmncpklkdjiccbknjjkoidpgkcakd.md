# Vulnerability Report: AI Content Detector - Copyleaks

## Metadata
- **Extension ID**: gplcmncpklkdjiccbknjjkoidpgkcakd
- **Extension Name**: AI Content Detector - Copyleaks
- **Version**: 4.4.1
- **Users**: Unknown (from public Chrome Web Store listing)
- **Manifest Version**: 3
- **Analysis Date**: 2026-02-15

## Executive Summary

AI Content Detector - Copyleaks is a legitimate browser extension developed by Copyleaks Ltd. that provides AI content detection capabilities. The extension allows users to scan web pages or selected text to determine if content was generated by AI or written by humans. The extension requires authentication to Copyleaks services and communicates with the company's backend API to perform analysis.

The static analysis flagged the extension as containing obfuscated code, but this is standard webpack bundling for Angular applications and not malicious obfuscation. The extension follows expected patterns for a legitimate SaaS service: user authentication, API communication with the vendor's servers, and local storage of user session data. No evidence of data exfiltration, credential theft, or other malicious behavior was found.

## Vulnerability Details

### 1. LOW: Broad Host Permissions Without User-Visible Justification

**Severity**: LOW
**Files**: manifest.json, content_script.js, background.js
**CWE**: CWE-250 (Execution with Unnecessary Privileges)

**Description**:
The extension requests `<all_urls>` host permissions, which grants access to all websites the user visits. While this is technically necessary for the extension's stated functionality (scanning any web page for AI-generated content), it represents a broad permission that could be misused.

**Evidence**:
```json
"host_permissions": ["<all_urls>"],
"content_scripts": [
  {
    "matches": ["<all_urls>"],
    "js": ["content_script.js"]
  }
]
```

The content script injects UI elements (quick access menu, text selection icon) into all web pages:
```javascript
static Run() {
  if (this.isPWA() || window.location.href.includes("chrome://")) return;
  const o = document.createElement("copyleaks-sidebar-popup");
  o.id = "copyleaks-sidebar-popup-container",
  document.documentElement.appendChild(o),
  o.classList.add("no-print"),
  this.addPrintStyles();
  // ... injects shadow DOM with styles and UI elements
}
```

**Verdict**:
This is a **minor concern** but not a vulnerability. The broad permissions are technically required for the extension's advertised functionality (allowing users to scan any web page). The content script only injects passive UI elements (floating button, text selection icon) and does not automatically collect or transmit page content without user action. The extension appropriately excludes PWAs and chrome:// URLs from injection.

## False Positives Analysis

### Obfuscation Flag
The static analyzer flagged the extension as "obfuscated," but examination of the code reveals this is standard webpack bundling used by Angular applications. The code contains:
- Readable function names and variable names (though some are minified)
- Standard Angular framework patterns
- Source maps (`.js.map` files) for debugging
- No actual obfuscation techniques like string encryption, control flow flattening, or intentional code mangling

This is **not** malicious obfuscation, just build tooling minification.

### Network Communication
The extension communicates with multiple Copyleaks domains, which is expected and disclosed behavior:
- `app.copyleaks.com/api/browser-extension` - Main API endpoint
- `app.copyleaks.com` - Dashboard/web interface
- `copyleaks.com` - Marketing/help site
- `id.copyleaks.com` - Identity/authentication service

All endpoints belong to the legitimate Copyleaks service. User content is sent to these endpoints for AI detection analysis, which is the core functionality of the extension.

### Authentication and Storage
The extension stores user authentication data in `chrome.storage.sync`:
```javascript
getUserAsync() {
  return (0, n.A)(function*() {
    if (r._user?.value) return r._user?.value;
    const h = yield chrome.storage.sync.get(p._.User);
    return r._user.next(h.user), r._user.value
  })()
}
```

This is standard practice for maintaining user sessions across browser restarts and is not a security concern.

## API Endpoints Analysis

| Endpoint | Purpose | Data Sent | Risk |
|----------|---------|-----------|------|
| `app.copyleaks.com/api/browser-extension/auth` | User authentication | Auth credentials | Low - HTTPS encrypted, legitimate service |
| `app.copyleaks.com` | Dashboard access | User session data | Low - Expected for account management |
| `copyleaks.com` | Marketing/help pages | None | None - Static content |
| `id.copyleaks.com` | Identity service | Authentication tokens | Low - Standard OAuth/auth flow |
| `copyleaks.com/thank-you-for-installing-ai-detector-extension` | Post-install page | None | None - One-time redirect |
| `docs.google.com/forms/...` | Uninstall feedback | None (user-initiated) | None - Optional survey |

## Background Script Behavior

The background service worker is minimal and performs only standard extension operations:
- Opens thank-you page on installation
- Sets badge text/color on updates
- Manages side panel opening/closing
- Handles messaging between content scripts and popup
- Stores UI preference settings (quick access menu, text selection icon)

No evidence of:
- Cookie harvesting
- Browsing history collection
- Automatic page content extraction
- Hidden network requests
- Keylogging or form interception

## Content Script Behavior

The content script injects UI elements into web pages:
1. **Quick Access Menu**: A draggable floating button that opens the side panel
2. **Text Selection Icon**: Shows an icon when 75+ characters are selected, allowing quick AI scan

The content script does **not**:
- Automatically read page content
- Hook fetch/XMLHttpRequest
- Intercept form submissions
- Monitor keyboard/mouse events beyond UI interaction
- Send data to external servers without user action

Content is only extracted and sent to Copyleaks when the user explicitly clicks "Scan Page" or "Detect AI" on selected text.

## Overall Risk Assessment

**RISK LEVEL: LOW**

**Justification**:
This is a legitimate commercial SaaS extension with no evidence of malicious behavior. The broad permissions (`<all_urls>`) are necessary for its core functionality and are used appropriately. The extension follows security best practices:
- Uses Manifest V3
- HTTPS-only communication with vendor servers
- No automatic data collection
- User-initiated analysis requests
- Transparent purpose and data usage

The single LOW-severity finding relates to the broad permission scope, which is technically overprivileged but functionally justified for the extension's use case. Users should be aware that installing this extension grants it access to all websites, though the extension only transmits data when explicitly requested.

**Recommendation**: Users concerned about privacy should be aware that content scanned through this extension is sent to Copyleaks servers for analysis. This is inherent to cloud-based AI detection and is not hidden behavior. The extension is safe for users who trust Copyleaks as a service provider.
